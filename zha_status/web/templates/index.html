<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ZHA Device Status</title>
    <style>
        body { font-family: sans-serif; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid black; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .offline { color: red; }
        .online { color: green; }
        .last-updated { font-style: italic; }
    </style>
</head>
<body>
    <h1>ZHA Device Status</h1>
    {% if data.timestamp %}
    <p class="last-updated">Last Data Update: {{ data.timestamp }}</p>
    {% else %}
    <p class="last-updated">No data collected yet.</p>
    {% endif %}
    <p><a href="/refresh">üîÅ Refresh Now</a></p>

    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Last Seen</th>
                <th>Area</th>
                <th>Manufacturer</th>
                <th>Model</th>
                <th>LQI</th>
                <th>RSSI</th>
                <th>IEEE</th>
                <th>Offline Count</th>  <th>Status</th>         </tr>
        </thead>
        <tbody>
            {% for d in data.devices %}
            <tr>
                <td>{{ d.name }}</td>
                <td>{{ d.last_seen if d.last_seen else 'N/A' }}</td>
                <td>{{ (d.area | replace(' ', '&nbsp;'))|safe if d.area else 'N/A' }}</td>
                <td>{{ d.manufacturer }}</td>
                <td>{{ d.model }}</td>
                <td>{{ d.lqi }}</td>
                <td>{{ d.rssi }}</td>
                <td>{{ d.ieee }}</td>
                <td>{{ d.offline_count }}</td>  <td class="{% if d.is_currently_offline %}offline{% else %}online{% endif %}">
                    {% if d.is_currently_offline %}Offline{% else %}Online{% endif %}
                </td> </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
